<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Phemto  -pye - a tiny editor for a tiny environment written in python</title>
<style>
h1,h2,h3 {margin:2 0 8 0}
body     {margin-left:15}
ul       {margin:1}
pre      {margin:1}
th       {font-family:monospace}
sup.h    {color:green;cursor:help;font-weight:bold;font-family:serif}
a.h      {color:green;font-weight:bold;font-family:serif;text-decoration:none}
i        {font-style:normal;font-weight:bold;font-family:courier}
#topBtn {
    display: none;          /* Hidden by default */
    position: fixed;        /* Fixed/sticky position */
    bottom: 55px;           /* Place the button from the bottom */
    right: 10px;            /* Place the button from the right */
    z-index: 99;            /* Make sure it does not overlap */
    border: none;
    outline: none;
    background-color: lightYellow;
    color: navy; 
    cursor: pointer;        /* Add a mouse pointer on hover */
    padding: 10px;          /* Some padding */
    border-radius: 10px;    /* Rounded corners */
}

#topBtn:hover { background-color: yellow /* Add a darker background on hover */
}

</style>
</head>

<body bgcolor=white style=font-size:120%>

<center>
<h2 style=font-family:sans-serif>Phemto</h2>
<small><small style=font-family:serif;>A python editor that's tiny for tiny environments</small></small>
<h1 style=font-family:sans-serif>pye</h1>
<h2 style=font-family:serif>User's Guide</h2>
</center>

<p>
Allows editing files directly on python based target boards, using a
terminal emulator such as MSWindows putty, Mac os terminal or Linux terminal.

<h3> Operations include:</h3>
<ul >
<li>open (existing or new file), save, quit<br>
<li>goto <var>line</var>, find, replace, <br>
<li>cut, copy, paste, redraw, undo, redo,<br>
<li>indent, dedent(remove leading whitespace), comment,<br>
<li>tab, backtab</i> and scrolling.
</ul>

<p>
<h3>Features</h3>

<ul>
<li>Action keys include: <i>^f</i>  find,  <i>^n</i> next, <i>^z</i> undo, <i> ^c</i> copy, <i> ^v</i> paste, &hellip; 
<li>Special keys, include: <i>home, end, page^</i>, &hellip;</i>
<li>Lines can be joined with cursor at the end of the line using <i>delete</i> or<br>
with cursor at the beginning with  <i>backspace</i>.
<li><i>enter</i> key inserts or splits a line with  automatic indentation.
<li>Command history permits multiple undo and redo.
<li>Status line shows row, column, etc.
<li>Multiple files can be edited simultaneously with multiple windows.
<li>Mouse scrolling and setting the cursor.
<li>Can be used with data files or program code.
<li>Online help
</ul>

<p>
The editor operates in insert mode, that is, characters typed are inserted, control+key and <span style=font-size:180%;vertical-align:middle;>&#x241B;</span>+key are commands.<br>
Cursor Keys, home, end, page^ &hellip; work as you would expect.


<h3>Installation</h3>
Transfer to the target board:
<ol><li>The code:
<ul>
<li> <i>pye.mpy</i> (frozen bytecode for Pyboard, ESP8266, ESP32, PyCom devices, Maixpy &hellip;) or 
<li> compiled byte code which reduces start-up time and saves memory and file space or
<li> <i>pye.py</i>  source 
</ul>
<li>The file  <i>h</i> for online help in an alternate window(optional).
</ol>
<p>

<h3 id=st>Starting <span style=font-family:monospace>pye</span></h3>
From python <i>REPL</i> prompt:<br>
<i>
>>>> from pye import pye<br>
>>>> <span style=color:silver>[</span>result =<span style=color:silver>]</span> pye(<span style=color:silver>[</span><var> object_1, object_2, &hellip;</var><span style=color:silver>[</span>,
tabsize=<var>n</var><span style=color:silver>][</span>, undo=<var>n</var> <span style=color:silver>][</span>, backup=y<span style=color:silver>]]</span>)</b>
</i>

<ul>
<li>If <i>object_<var>n</var></i> is a string ( example "<i>main.py"</i> it's a file or a directory (example <i>"/flash"</i>) .

<ul>
<li> For a <b>file</b>, the content will be loaded. <br>
If the file does not exist an empty edit window is opened and it is given that name. 

<li> For a <b>directory</b>, the list of file names will be loaded to the edit window. 

<pre><i> Directory
          /flash
          boot.py
          main.py</i></pre>

<li>For <i>pye()</i> the list of files in current directory is used.  <p>

<li>For a <b><var>list</var></b> of strings, (example ( <i>["start","stuff","end"]</i>) they will be loaded into the editing window <p>

</ul>
<li>If <b><var>object_n</var ></b> is not a string nor a list of strings, for example:<i> pye( var )</i>, ( where var is not defined )
an empty window is opened. 
</ul>

<p>
Optional named parameters:<br>
<ul>
<li>tabsize =<var>n</var> Tab step (integer). The default is 4.
<li>undo=<var>n</var> history size (integer). The minimum size is 4.
<!-- <li>backup=y/n Adds a  '~' (tilde) to original filename before saving changes.      2.73 -->
</ul>

<!-- /* 
When the user scrolls down from the top of the document, show the button
When user clicks on button go to id=top
uses  <link rel=stylesheet href=top.css type=text/css>
*/ -->
<script>
window.onscroll = function () { scrollFunction() };
function scrollFunction() {     // hide or show button    ADD to EVERY page so only shows up on big pages!
    if    ( document.body.scrollTop > 400 || document.documentElement.scrollTop > 400)  // Safari? firefox? chrome? Ms explorer?
          { document.getElementById("topBtn").style.display="block"; }
     else { document.getElementById("topBtn").style.display="none"; }      <!-- DGG -->
                                    }
function topFunction() {
    var scroll_element = document.getElementById("top");
    scroll_element.scrollIntoView();
                                }
document.write('<button onclick="topFunction()" id=topBtn title="Go to top "><b>keys</b></button> <a id=top>');

</script>
<h3>Keystroke commands</h3>

<ul><i>^</i> indicates:<li>
 hold the ctrl key while pressing the next key or
<li>press the <span style=font-size:180%;vertical-align:middle;>&#x241B;</span> key then then next key.</em></ul>

<table border=1 cellpadding=5 cellspacing=0 style=font-size:120%>
<tr><th style=font-family:serif>Function<th style=font-family:serif>Keys

 <tr><td><b>Open</b> a new file to a window                                 <th> ^o
<tr><td><b>Save</b>                                       <th> <span style=font-size:180%;vertical-align:middle;>&#x241B;</span>s
<tr><td><b>Quit</b> a file window
or the line edit mode.                                                      <th> ^q <br>
<span style=font-size:190%;vertical-align:middle;>&#x241B;&#x241B</span>
<tr><td><b>Next window</b>                                                  <th> ^W

<tr><th  style=font-family:serif colspan=2> Inserting<br>
 <tr><td>Characters typed are inserted<td>
<tr><td><b>Tab</b> If text is selected indent the selection.                <th> [tab]
<tr><td>line <b>break</b> at the cursor position.  Auto-indent depends on setting.
<a href=#a class=h><sup>&dagger;</sup></a>
                                                                        <th>Enter</b>

<tbody bgcolor=azure>

<tr><th style=font-family:serif colspan=2 > Movement <br> go to:
<tr><td><b>Top</b> of the file                                              <th> ^t 
<tr><td><b>left</b>
to the start of the actual or previous symbol
skipping over to the previous line.                                         <th valign=top>^&larr;

<tr><td><b>Start-of-line</b>  OR  <b>start-of-text</b>                  <th> [home]
<tr><td><b>right</b> behind the next symbol or line end,
wrapping over to the next line.                                             <th valign=top> ^&rarr;
<tr><td><b>end-of-code</b>    OR      <b>End-of-line</b>                <th> [end]


<tr><td><b>Line #</b><th> ^g
<tr><td><b>Bottom</b> of the file                                               <th> ^b <br> ^[end]</b><b>

<tr><td><b>Matching</b> bracket</b>.  The cursor must be on the  bracket.  <br>
Bracket pairs are ( ), [ ], { } and &lt; >                                  <th valign=top> ^k<br>

<tr><td><b>Current line or selected </b> up/down with the cursor 
                                                                         <th style=white-space:nowrap;> ^&uarr; <small>/</small> ^&darr;
<tr><td><b>Cursor up / down </b> a screen <th> PgUp PgDn

<tr><td><b>Scroll</b> the window</b> Up/Down</b>                        <th>^&uarr; <small>/</small>  ^&darr;






<tbody bgcolor=gainsboro>
<tr><th  style=font-family:serif colspan=2>Selecting text

<tr><td><b>Start selection </b> <br>
Once selecting is started it can be extended by moving the cursor. <br>
The selection is effected by Delete, Backspace, Copy, Cut, Paste, Tab,
Backtab, Find, Save and Replace. <br>

<b>End selecting</b> by pressing  <i>^L</i> or <i>^space</i> or an operation on selection . <th> shift-&rarr; <small>/</small>  &larr;<p>
                                                                                                ^L <p>    ^space 

<tr><td><b>Select previous/next</b> word or extend the Selection.               <th> ^shift-&larr; <small>/</small> &rarr;
<tr><td><b>Copy selection </b> to the clipboard                                 <th> ^c
<tr><td><b>Cut selection</b>  to the clipboard.
The selection is cleared.  <br>
This implements the "Cut &amp; Paste" feature.                                  <th valign=top> ^x

<tr><td><b>Paste </b> the <b>clipboard</b> at the cursor position.  <br>
If text is selected, it is replaced. <br>
In the line edit mode: paste the item under the cursor.                         <th> ^v


<tbody bgcolor=mistyrose>
<tr ><th  style=font-family:serif colspan=2>Deleting</h3>
<tr><td><b>Selection </b>                                                   <th> [del] <br> [backspace]

<tr><td><b>Char left</b> of the cursor.  <br>
Join</b> to the previous line if cursor is at the beginning of the line. <br>
                                                                             <th valign=middle> [backspace]


<tr><td><b>Char under</b> (before) the cursor. <br>
Join with the next line if cursor is at the end of the line <br>
With auto-indent, delete the leading spaces of the line.                           <th> [del]

<tr><td><b>Word</b> under the cursor or spaces up to the next non-space.           <th> ^[del]
<tr><td><b>Line</b>                                                                <th> shift[del]
<tr><td><b>Un-indent</b>  a single line  or multiple selected lines. <th> ^u <br>[backtab]

<tbody>
<tr><th  style=font-family:serif colspan=2>Finding
<tr><td><b>Find</b> a regular expression. <br>
 For example <i>^def</i><sup class=h title=" the ^ here is not CTRL 
rather it is the regular expression anchor 
to beginning of the line">&dagger;</sup> finds <i>def</i> at the beginning of a line.<br>
Skips a selection.<br>
Case sensitivity is set by <a href=#a><i>^a</i></a>.  Stops at the end of file.<br>
The search string is remembered.                                                      <th> ^f

<tr><td><b>Next </b>find</b>                                                               <th> ^n

<tr><td><b>Find and replace</b>. Optionally:&nbsp; <code>yes, all, no</code><small>(skip)</small><code>, quit</code><br>
With a selection only the selection is searched and <code>all</code> only applies to the selection. <th>^r

<tbody>
<tr><th  style=font-family:serif colspan=2>Additional Commands

<tr><td><b>Redraw</b> the screen and display file size and free space        <br> 
<small><code style=background-color:aqua>
*main.py Row: 5/116 Col: 30. 2524KB Memory free. File 213KB, 3121KB free.</code></small>
                                                                                <th> ^e
<tr><td><b>Undo</b> the last change(s).                                         <th> ^z
<tr><td><b>Redo</b>  the operation undone by Undo
immediately after Undo(s). <br>
Any change to the text invalidates the redo history.                            <th> ^y

<tbody>
<tr><td><b>Comment / Uncomment</b> a line or selected area.  <br>
That is, insert / remove the comment character(s) (default '<i>#</i>')          <th>^p <br> ^_
<tr id=a ><td>Adjust <b>Attributes</b> that is those provided when <i>pye</i> was <a href=#st>started</a>. <br>
Enter 'y' or 'n' or a number in comma separated fields (example:<i>n,y,4,n</i>) <br>
Empty field leaves the value unchanged. <p>

<ul>The defaults are :<br>
<li>auto-indent: y <br>
<li>search case sensitive: n<br>
<li>tab-size: 4<br>
<li>comment string #<br>
<li>write-tabs: n <br>
<li>positioning of the cursor during vertical moves <br>
(straight vs.  following line ends).<th>^a
</ul>


<tbody bgcolor=linen>
<tr><th  style=font-family:serif colspan=3> Mouse actions
<tr><td>Set the cursor.<th>Button 1
<tr><td>Set / Clear highlighting.<th>Button 2
<tr><td>Scroll Up / Down the screen content by 3 lines per tick. <th>Scroll Wheel

</table>
<p>





<h2>Additional notes</h2>

<p>
<h3>Status line</h3>
<table><tr><td>
<i style=background-color:aqua>*main.py Row: 5/116 Col: 30 <br>
^- Astrix indicates window contents have been changed.</i>
</table>
<p>
For online help use <i>^oh</i> to open the file <i>h</i> in a new window and use <i>^w</i>
to toggle between helpfile and editing window.

<p>

When opening a new window the file name will be prompted for. <br>
If the name is empty, an empty window will be opened. <br>
If the file cannot be loaded (for example it does not exist),<br>
&nbsp;&nbsp;an empty window with that name will be opened. <br>
If the name is a directory a list of file names will be loaded.

<p>

<h3>Exiting</h3>

<p>

The last window closed, determines the return value. 

<p >When saving an unnamed window, the file name will be prompted for. <br>
The content is written to a temporary file (basename + ?.pyetmp?) then it is
renamed to the specified filename. If the target file name is invalid, the
temporary file will have the content. After saving the window be named as the
saved file, which acts as Save-as.

<p>
For quit if the edited text was changed, ask for confirmation. <br>
If the last buffer is closed, the editor terminates.
<p>
For save:
The name of the file will be returned when pye exits. <br>

The option to replace <b>all</b> sequences of spaces <b>by
tabs</b>, tab size 8. If the initial file contained tab characters, this is the default. 

<p >When editing a list, the list is returned when pye exits.

<p> When editing a directory the name of the directory will be returned when pye exits. 
<p> When reading files, tabs are replaced by spaces, tab size 8, and white space at the end of a line is discarded. <br>

<p>
The undo stack size per window is set on the call to <i>pye()</i> default: micro 50, PC systems 500.


<p>
<h3>PC Usage</h3>
<p>
The PC version can be called from the command line with:<br>
<i>pye [<var>filename(s</var>)]</i>

<p>
Using python3 content can be redirected or pipe'd into the editor.

<p>

<h3>Internals</h3>

<p >
Uses stdin/stdout on the MicroPython boards.
<p>
For WiPy1, <b>only</b> the Pre-Compiled version fits, unless using Telnet with the UART session closed. 
<p>
The size of a file that can be edited is limited by the memory of the target. <br>
REDRAW  updates available memory show in the status line.
In addition to the file, clipboard and especially undo consume memory. <br>
The undo stack can be limited in the call to <i>pye</i> using <i>undo=<var>n</var></i>. <br>
The clipboard size can be reduced by copying a single line into it. <br>
Files up to about 13kb on ESP8266 and 68kb characters on PyBoard should be safe to edit. <br>
The largest suitable file size is in the same order of what can be handled as source file.

<p>
When saving a file on PyBoard, the changes may not
be visible in the file system of a connected PC until you disconnect and
reconnect the Pyboard drive. <br>
See also the related discussion in the MicroPython Forum.

<p >
Saving to the internal flash file system of PyBoard is slow.
<p>

In some cases, Escape seems to lock the keyboard, it unlocks by typing any alpha character.

<h2 >Terminal Emulators</h2>
<!-- see the Pyboard_Editor.7.2.doc for interals:

The keyboard mapping and screen commands expect ANSI (aka VT100) codes.  <br>


The <u>delete</u> key must be set to ASCII-Del.

<p >Empty cells are the same as puttyVT100 &amp; Xterm

<table border=1 cellspacing=0 cellpadding=3>
  
<tr> <th ><b>  Key <th align=center><b> Putty VT100 <br>&amp;<br> Xterm <th><b> Putty esc-[~ <th><b>Putty Linux <th><b>Minicom <th><b> GtkTerm <th><b> Picocom <th><b>Linux Terminal<br> TERM=ANSI 
<tr> <th> Up <th> \e[A <th> <th> <th> <th> <th> <th> 
<tr> <th> Down <th> \e[B <th> <th> <th> <th> <th> <th>
<tr> <th> Left <th> \e[D <th> <th> <th> <th> <th> <th>
<tr> <th> Right <th> \e[C <th> <th> <th> <th> <th> <th>
<tr> <th> Home <th> \e[1~ <th> <th> <th> <th> \eOH <th> \eOH <th> \e[H 
<tr> <th> End <th> \e[4~ <th> <th> <th> \eOF <th> \eOF <th> \eOF <th> \e[F 
<tr> <th> Ins <th> \e[2~ <th> <th> <th> <th> <th> <th>
<tr> <th> Del <th> \e[3~ <th> <th> <th> <th> <th> <th>
<tr> <th> PgUp <th> \e[5~ <th> <th> <th> <th> <th> <th>
<tr> <th> PgDn <th> \e[6~ <th> <th> <th> <th> <th> <th>
<tr> <th> Backspace <th> \x7f <th> <th> <th> <th> \x08 <th> <th> 
<tr> <th> Ctrl-Home <th> <th> <th> <th> \e[1;5H <th> &nbsp; <th> \e[1;5H <th> \e[1;5H 
<tr> <th> Ctrl-End <th> <th> <th> <th> \e[1;5F <th> &nbsp; <th> \e[1;5F <th> \e[1;5F 
<tr> <th> Ctrl-Del <th> <th> <th> <th> \e[3;5~ <th> \e[3;5~ <th> \e[3;5~ <th> \e[3;5~ 
<tr> <th>Tab <th> \x09 <th> <th> <th> <th> <th> <th> 
<tr> <th>BackTab <th>\e[Z <th> <th> <th> <th> <th> <th>
</table>


<br>
If the KEYMAP is too large, and you know which terminal you are working on,
delete or comment out the unneeded lines. If your terminal is different change
the control codes.

-->

<ul >
<li><b>Windows</b>
<ul>
Terminal emulators behave inconsistently.<br>
Best choices are <b>Putty, TeraTerm  or Xsh20 </u></b><br>
<li><b>Putty</b> does not report mouse actions, and does not return code for shift-arrow keys. <br>
<li><b>TeraTerm, IVT terminal and Xsh20</b> report the mouse click, but not the scroll wheel actions.<br>
<li><b>ZOC</b> reports mouse positions constantly, and <br>
sends no key codes for Home, End, PgUp, PGDn and Del. <br>
<li><b>PowerVT</b> sends no key codes for Home, End, PgUp, PGDn and Del. <br>
<li><b>Hyperterminal's</b> VT100 emulation is poor.
</ul>
<li><b>Linux</b>

<ul>
<li><b>Gnome</b> terminal sometimes does not send the first mouse wheel code, after the pointer
was moved into the window. <br>
<li><b>Mate and XFCE4</b> have slightly different keyboard mappings.<br>
<li><b> Picocom</b> sometimes sends Linux Terminal codes. 
</ul>

<li><b>Mac OS</b>
<ul>
<li>terminal
<ul>

</ul>
</ul>
</ul>
<p >
See <i style=font-weight:normal>Pyboard_Editor.doc</i> in GitHub for additional details.

<p align=right>
<small><small>DGerman&#x40Real-World-Systems.com version 1.2, 6/17/22 for pye version 2.73</small></small>

</body>

</html>
